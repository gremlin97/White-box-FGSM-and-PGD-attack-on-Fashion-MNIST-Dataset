Loading datasets...
Done!
Start training...
100%|██████████████████████████████████████████████| 782/782 [01:03<00:00, 12.39it/s]
100%|██████████████████████████████████████████████| 157/157 [00:05<00:00, 27.64it/s]
Val Epoch 1 loss:0.4062945153682854
Train Epoch 1 loss:0.5647270641935146
100%|██████████████████████████████████████████████| 782/782 [00:43<00:00, 17.89it/s]
100%|██████████████████████████████████████████████| 157/157 [00:03<00:00, 41.91it/s]
Val Epoch 2 loss:0.3333856725389031
Train Epoch 2 loss:0.3590180172449183
100%|██████████████████████████████████████████████| 782/782 [00:52<00:00, 14.91it/s]
100%|██████████████████████████████████████████████| 157/157 [00:07<00:00, 21.22it/s]
Val Epoch 3 loss:0.2959924799146926
Train Epoch 3 loss:0.31093739636261447
100%|██████████████████████████████████████████████| 782/782 [01:06<00:00, 11.76it/s]
100%|██████████████████████████████████████████████| 157/157 [00:09<00:00, 17.31it/s]
Val Epoch 4 loss:0.3019228730421917
Train Epoch 4 loss:0.2814372767649038
100%|██████████████████████████████████████████████| 782/782 [01:13<00:00, 10.66it/s]
100%|██████████████████████████████████████████████| 157/157 [00:09<00:00, 16.04it/s]
Val Epoch 5 loss:0.2645978319701875
Train Epoch 5 loss:0.2566862308022464
100%|██████████████████████████████████████████████| 782/782 [01:14<00:00, 10.46it/s]
100%|██████████████████████████████████████████████| 157/157 [00:10<00:00, 15.14it/s]
Val Epoch 6 loss:0.265708953877733
Train Epoch 6 loss:0.23910729638050737
100%|██████████████████████████████████████████████| 782/782 [01:17<00:00, 10.04it/s]
100%|██████████████████████████████████████████████| 157/157 [00:10<00:00, 15.52it/s]
Val Epoch 7 loss:0.24212532742008283
Train Epoch 7 loss:0.22069306354350446
100%|██████████████████████████████████████████████| 782/782 [01:21<00:00,  9.60it/s]
100%|██████████████████████████████████████████████| 157/157 [00:11<00:00, 14.21it/s]
Val Epoch 8 loss:0.24850567719738953
Train Epoch 8 loss:0.2067434003962504
100%|██████████████████████████████████████████████| 782/782 [01:21<00:00,  9.60it/s]
100%|██████████████████████████████████████████████| 157/157 [00:10<00:00, 14.43it/s]
Val Epoch 9 loss:0.23411466954809845
Train Epoch 9 loss:0.19411768436508106
100%|██████████████████████████████████████████████| 782/782 [01:20<00:00,  9.66it/s]
100%|██████████████████████████████████████████████| 157/157 [00:13<00:00, 11.59it/s]
Val Epoch 10 loss:0.24448680891922325
Train Epoch 10 loss:0.1837993018672137
100%|██████████████████████████████████████████████| 782/782 [01:20<00:00,  9.75it/s]
100%|██████████████████████████████████████████████| 157/157 [00:10<00:00, 14.75it/s]
Val Epoch 11 loss:0.23751903073802874
Train Epoch 11 loss:0.17096630692043724
100%|██████████████████████████████████████████████| 782/782 [01:18<00:00,  9.95it/s]
100%|██████████████████████████████████████████████| 157/157 [00:09<00:00, 15.75it/s]
Val Epoch 12 loss:0.24565954985702113
Train Epoch 12 loss:0.15970869717733635
100%|██████████████████████████████████████████████| 782/782 [01:14<00:00, 10.49it/s]
100%|██████████████████████████████████████████████| 157/157 [00:09<00:00, 16.08it/s]
Val Epoch 13 loss:0.22835071991156242
Train Epoch 13 loss:0.15014071885229605
100%|██████████████████████████████████████████████| 782/782 [01:13<00:00, 10.61it/s]
100%|██████████████████████████████████████████████| 157/157 [00:08<00:00, 17.63it/s]
Val Epoch 14 loss:0.2298345351769666
Train Epoch 14 loss:0.13994641558450582
100%|██████████████████████████████████████████████| 782/782 [01:12<00:00, 10.80it/s]
100%|██████████████████████████████████████████████| 157/157 [00:09<00:00, 16.43it/s]
Val Epoch 15 loss:0.21787212191114
Train Epoch 15 loss:0.13015440906948217
100%|██████████████████████████████████████████████| 782/782 [01:13<00:00, 10.69it/s]
100%|██████████████████████████████████████████████| 157/157 [00:09<00:00, 16.88it/s]
Val Epoch 16 loss:0.23739465708091
Train Epoch 16 loss:0.12182975033788807
100%|██████████████████████████████████████████████| 782/782 [01:12<00:00, 10.78it/s]
100%|██████████████████████████████████████████████| 157/157 [00:09<00:00, 17.13it/s]
Val Epoch 17 loss:0.2349758329949561
Train Epoch 17 loss:0.11394014274296553
100%|██████████████████████████████████████████████| 782/782 [01:12<00:00, 10.84it/s]
100%|██████████████████████████████████████████████| 157/157 [00:10<00:00, 14.63it/s]
Val Epoch 18 loss:0.240895266425173
Train Epoch 18 loss:0.10490181952800669
100%|██████████████████████████████████████████████| 782/782 [01:16<00:00, 10.26it/s]
100%|██████████████████████████████████████████████| 157/157 [00:09<00:00, 17.43it/s]
Val Epoch 19 loss:0.22475114217989003
Train Epoch 19 loss:0.09708332875148033
100%|██████████████████████████████████████████████| 782/782 [01:09<00:00, 11.23it/s]
100%|██████████████████████████████████████████████| 157/157 [00:08<00:00, 17.58it/s]
Val Epoch 20 loss:0.247786190052321
Train Epoch 20 loss:0.09114600363475701
100%|██████████████████████████████████████████████| 782/782 [01:11<00:00, 10.99it/s]
100%|██████████████████████████████████████████████| 157/157 [00:09<00:00, 16.94it/s]
Val Epoch 21 loss:0.24809006969355474
Train Epoch 21 loss:0.08317582293168244
100%|██████████████████████████████████████████████| 782/782 [01:11<00:00, 11.00it/s]
100%|██████████████████████████████████████████████| 157/157 [00:08<00:00, 18.16it/s]
Val Epoch 22 loss:0.24032953260525777
Train Epoch 22 loss:0.07652952028509906
100%|██████████████████████████████████████████████| 782/782 [01:09<00:00, 11.18it/s]
100%|██████████████████████████████████████████████| 157/157 [00:08<00:00, 18.65it/s]
Val Epoch 23 loss:0.2632204657242556
Train Epoch 23 loss:0.07129055817368561
100%|██████████████████████████████████████████████| 782/782 [01:05<00:00, 11.96it/s]
100%|██████████████████████████████████████████████| 157/157 [00:07<00:00, 20.19it/s]
Val Epoch 24 loss:0.27912898784040646
Train Epoch 24 loss:0.06627931756079387
100%|██████████████████████████████████████████████| 782/782 [01:04<00:00, 12.08it/s]
100%|██████████████████████████████████████████████| 157/157 [00:07<00:00, 20.25it/s]
Val Epoch 25 loss:0.2572160185830798
Train Epoch 25 loss:0.061880909540044986
Done!
Evaluate on validation set...
100%|██████████████████████████████████████████████| 157/157 [00:07<00:00, 21.34it/s]
Evaluation accuracy: 0.9193
Evaluate on test set
100%|██████████████████████████████████████████████| 157/157 [00:07<00:00, 20.57it/s]
Evaluation accuracy: 0.9191
Network(
  (conv1): Conv2d(1, 20, kernel_size=(5, 5), stride=(1, 1), padding=(2, 2))
  (pool): MaxPool2d(kernel_size=(2, 2), stride=(2, 2), padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(20, 50, kernel_size=(5, 5), stride=(1, 1), padding=(2, 2))
  (fc1): Linear(in_features=2450, out_features=500, bias=True)
  (fc2): Linear(in_features=500, out_features=10, bias=True)
)
[0.4062945153682854, 0.3333856725389031, 0.2959924799146926, 0.3019228730421917, 0.2645978319701875, 0.265708953877733, 0.24212532742008283, 0.24850567719738953, 0.23411466954809845, 0.24448680891922325, 0.23751903073802874, 0.24565954985702113, 0.22835071991156242, 0.2298345351769666, 0.21787212191114, 0.23739465708091, 0.2349758329949561, 0.240895266425173, 0.22475114217989003, 0.247786190052321, 0.24809006969355474, 0.24032953260525777, 0.2632204657242556, 0.27912898784040646, 0.2572160185830798]
[0.5647270641935146, 0.3590180172449183, 0.31093739636261447, 0.2814372767649038, 0.2566862308022464, 0.23910729638050737, 0.22069306354350446, 0.2067434003962504, 0.19411768436508106, 0.1837993018672137, 0.17096630692043724, 0.15970869717733635, 0.15014071885229605, 0.13994641558450582, 0.13015440906948217, 0.12182975033788807, 0.11394014274296553, 0.10490181952800669, 0.09708332875148033, 0.09114600363475701, 0.08317582293168244, 0.07652952028509906, 0.07129055817368561, 0.06627931756079387, 0.061880909540044986]


#=============================================================================#

(adml) gremlin@DESKTOP-IR30Q20:~/Documents/Fairness$ python train_fmnist.py
Loading datasets...
Done!
Start training...
100%|██████████████████████████████████████████████| 782/782 [01:08<00:00, 11.42it/s]
100%|██████████████████████████████████████████████| 157/157 [00:06<00:00, 25.53it/s]
Val Epoch 1 loss:0.4257260781184883
Train Epoch 1 loss:0.5889059642086858
100%|██████████████████████████████████████████████| 782/782 [01:08<00:00, 11.34it/s]
100%|██████████████████████████████████████████████| 157/157 [00:08<00:00, 19.08it/s]
Val Epoch 2 loss:0.36716736691772556
Train Epoch 2 loss:0.38288875572059466
100%|██████████████████████████████████████████████| 782/782 [02:32<00:00,  5.12it/s]
100%|██████████████████████████████████████████████| 157/157 [00:18<00:00,  8.50it/s]
Val Epoch 3 loss:0.32609525171055154
Train Epoch 3 loss:0.32713410390726744
100%|██████████████████████████████████████████████| 782/782 [03:07<00:00,  4.18it/s]
100%|██████████████████████████████████████████████| 157/157 [00:23<00:00,  6.82it/s]
Val Epoch 4 loss:0.29668964981842955
Train Epoch 4 loss:0.2936518343398943
100%|██████████████████████████████████████████████| 782/782 [03:27<00:00,  3.77it/s]
100%|██████████████████████████████████████████████| 157/157 [00:27<00:00,  5.74it/s]
Val Epoch 5 loss:0.29430167908501476
Train Epoch 5 loss:0.2708693424339794
100%|██████████████████████████████████████████████| 782/782 [03:44<00:00,  3.48it/s]
100%|██████████████████████████████████████████████| 157/157 [00:29<00:00,  5.28it/s]
Val Epoch 6 loss:0.26637435495663603
Train Epoch 6 loss:0.24891953910117412
100%|██████████████████████████████████████████████| 782/782 [03:15<00:00,  4.00it/s]
100%|██████████████████████████████████████████████| 157/157 [00:29<00:00,  5.37it/s]
Val Epoch 7 loss:0.2604825526096259
Train Epoch 7 loss:0.23006364483090921
100%|██████████████████████████████████████████████| 782/782 [03:06<00:00,  4.20it/s]
100%|██████████████████████████████████████████████| 157/157 [00:29<00:00,  5.36it/s]
Val Epoch 8 loss:0.25321922071610287
Train Epoch 8 loss:0.21774655497630538
100%|██████████████████████████████████████████████| 782/782 [02:54<00:00,  4.47it/s]
100%|██████████████████████████████████████████████| 157/157 [00:18<00:00,  8.54it/s]
Val Epoch 9 loss:0.24680328876919047
Train Epoch 9 loss:0.20115012681716696
100%|██████████████████████████████████████████████| 782/782 [02:16<00:00,  5.72it/s]
100%|██████████████████████████████████████████████| 157/157 [00:17<00:00,  9.19it/s]
Val Epoch 10 loss:0.24056708770003288
Train Epoch 10 loss:0.18768480321025605
100%|██████████████████████████████████████████████| 782/782 [02:14<00:00,  5.80it/s]
100%|██████████████████████████████████████████████| 157/157 [00:19<00:00,  8.24it/s]
Val Epoch 11 loss:0.24168577837716243
Train Epoch 11 loss:0.1753708743835654
100%|██████████████████████████████████████████████| 782/782 [02:20<00:00,  5.55it/s]
100%|██████████████████████████████████████████████| 157/157 [00:19<00:00,  8.14it/s]
Val Epoch 12 loss:0.23337336964193423
Train Epoch 12 loss:0.16427724268954352
100%|██████████████████████████████████████████████| 782/782 [02:23<00:00,  5.45it/s]
100%|██████████████████████████████████████████████| 157/157 [00:16<00:00,  9.55it/s]
Val Epoch 13 loss:0.23611693504224918
Train Epoch 13 loss:0.15523697458245717
100%|██████████████████████████████████████████████| 782/782 [02:38<00:00,  4.95it/s]
100%|██████████████████████████████████████████████| 157/157 [00:20<00:00,  7.51it/s]
Val Epoch 14 loss:0.25560121978544126
Train Epoch 14 loss:0.14262583207510546
100%|██████████████████████████████████████████████| 782/782 [02:51<00:00,  4.55it/s]
100%|██████████████████████████████████████████████| 157/157 [00:22<00:00,  6.91it/s]
Val Epoch 15 loss:0.2360532294223263
Train Epoch 15 loss:0.13361776973504355
100%|██████████████████████████████████████████████| 782/782 [03:02<00:00,  4.28it/s]
100%|██████████████████████████████████████████████| 157/157 [00:24<00:00,  6.32it/s]
Val Epoch 16 loss:0.24569595303789826
Train Epoch 16 loss:0.12313276777506027
100%|██████████████████████████████████████████████| 782/782 [03:17<00:00,  3.95it/s]
100%|██████████████████████████████████████████████| 157/157 [00:25<00:00,  6.17it/s]
Val Epoch 17 loss:0.23736969891722035
Train Epoch 17 loss:0.11256759425344141
100%|██████████████████████████████████████████████| 782/782 [02:57<00:00,  4.41it/s]
100%|██████████████████████████████████████████████| 157/157 [00:21<00:00,  7.15it/s]
Val Epoch 18 loss:0.23945552687261515
Train Epoch 18 loss:0.10677203874025122
100%|██████████████████████████████████████████████| 782/782 [03:43<00:00,  3.50it/s]
100%|██████████████████████████████████████████████| 157/157 [00:23<00:00,  6.59it/s]
Val Epoch 19 loss:0.2442877236160503
Train Epoch 19 loss:0.0975960445854708
100%|██████████████████████████████████████████████| 782/782 [02:41<00:00,  4.85it/s]
100%|██████████████████████████████████████████████| 157/157 [00:17<00:00,  9.01it/s]
Val Epoch 20 loss:0.24630129818988453
Train Epoch 20 loss:0.08902208661050785
100%|██████████████████████████████████████████████| 782/782 [03:04<00:00,  4.25it/s]
100%|██████████████████████████████████████████████| 157/157 [00:24<00:00,  6.32it/s]
Val Epoch 21 loss:0.26958139537341275
Train Epoch 21 loss:0.08268591937968683
100%|██████████████████████████████████████████████| 782/782 [03:46<00:00,  3.46it/s]
100%|██████████████████████████████████████████████| 157/157 [00:23<00:00,  6.77it/s]
Val Epoch 22 loss:0.2512653676235372
Train Epoch 22 loss:0.07953466581719001
100%|██████████████████████████████████████████████| 782/782 [02:42<00:00,  4.83it/s]
100%|██████████████████████████████████████████████| 157/157 [00:17<00:00,  8.80it/s]
Val Epoch 23 loss:0.25979847280652657
Train Epoch 23 loss:0.07156136242346481
100%|██████████████████████████████████████████████| 782/782 [03:11<00:00,  4.09it/s]
100%|██████████████████████████████████████████████| 157/157 [00:31<00:00,  4.91it/s]
Val Epoch 24 loss:0.28416761036986
Train Epoch 24 loss:0.06532707511592666
100%|██████████████████████████████████████████████| 782/782 [03:45<00:00,  3.47it/s]
100%|██████████████████████████████████████████████| 157/157 [00:27<00:00,  5.67it/s]
Val Epoch 25 loss:0.2867789554652894
Train Epoch 25 loss:0.05998741107447373
Done!
Evaluate on validation set...
100%|██████████████████████████████████████████████| 157/157 [00:26<00:00,  5.95it/s]
Evaluation accuracy: 0.9153
Evaluate on test set
100%|██████████████████████████████████████████████| 157/157 [00:27<00:00,  5.67it/s]
Evaluation accuracy: 0.9163
Network(
  (conv1): Conv2d(1, 20, kernel_size=(5, 5), stride=(1, 1), padding=(2, 2))
  (pool): MaxPool2d(kernel_size=(2, 2), stride=(2, 2), padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(20, 50, kernel_size=(5, 5), stride=(1, 1), padding=(2, 2))
  (fc1): Linear(in_features=2450, out_features=500, bias=True)
  (fc2): Linear(in_features=500, out_features=10, bias=True)
)
100%|██████████████████████████████████████████████| 157/157 [01:00<00:00,  2.58it/s]
Test accuracy on Attacked Test Data is: 0.1584 and Attack accuracy is: 0.8416
0.1584
(adml) gremlin@DESKTOP-IR30Q20:~/Documents/Fairness$ 

#=================================================#

(adml) gremlin@DESKTOP-IR30Q20:~/Documents/Fairness$ python train_fmnist.py 
Loading datasets...
Done!
Start training...
100%|██████████████████████████████████████████████| 782/782 [00:51<00:00, 15.12it/s]
100%|██████████████████████████████████████████████| 157/157 [00:03<00:00, 45.08it/s]
Val Epoch 1 loss:0.4279410038024757
Train Epoch 1 loss:0.5835413876015817
100%|██████████████████████████████████████████████| 782/782 [00:44<00:00, 17.49it/s]
100%|██████████████████████████████████████████████| 157/157 [00:04<00:00, 33.12it/s]
Val Epoch 2 loss:0.3685870794164147
Train Epoch 2 loss:0.37555817425098564
100%|██████████████████████████████████████████████| 782/782 [01:04<00:00, 12.12it/s]
100%|██████████████████████████████████████████████| 157/157 [00:08<00:00, 18.17it/s]
Val Epoch 3 loss:0.3147343508187373
Train Epoch 3 loss:0.3236388789532739
100%|██████████████████████████████████████████████| 782/782 [01:22<00:00,  9.49it/s]
100%|██████████████████████████████████████████████| 157/157 [00:10<00:00, 15.34it/s]
Val Epoch 4 loss:0.2857628309992468
Train Epoch 4 loss:0.2886501337351549
100%|██████████████████████████████████████████████| 782/782 [01:23<00:00,  9.41it/s]
100%|██████████████████████████████████████████████| 157/157 [00:10<00:00, 15.03it/s]
Val Epoch 5 loss:0.27223301859228477
Train Epoch 5 loss:0.2619725280653333
100%|██████████████████████████████████████████████| 782/782 [01:20<00:00,  9.73it/s]
100%|██████████████████████████████████████████████| 157/157 [00:10<00:00, 15.16it/s]
Val Epoch 6 loss:0.25643107722139663
Train Epoch 6 loss:0.24296826271869032
100%|██████████████████████████████████████████████| 782/782 [01:19<00:00,  9.78it/s]
100%|██████████████████████████████████████████████| 157/157 [00:10<00:00, 15.32it/s]
Val Epoch 7 loss:0.2501304350840818
Train Epoch 7 loss:0.22502874549659316
100%|██████████████████████████████████████████████| 782/782 [01:27<00:00,  8.95it/s]
100%|██████████████████████████████████████████████| 157/157 [00:11<00:00, 13.86it/s]
Val Epoch 8 loss:0.2483010812644746
Train Epoch 8 loss:0.21000921461836
100%|██████████████████████████████████████████████| 782/782 [01:27<00:00,  8.93it/s]
100%|██████████████████████████████████████████████| 157/157 [00:12<00:00, 12.78it/s]
Val Epoch 9 loss:0.24345385302214106
Train Epoch 9 loss:0.1965872533143024
100%|██████████████████████████████████████████████| 782/782 [01:30<00:00,  8.61it/s]
100%|██████████████████████████████████████████████| 157/157 [00:12<00:00, 12.26it/s]
Val Epoch 10 loss:0.24206850650441494
Train Epoch 10 loss:0.18180083368650024
100%|██████████████████████████████████████████████| 782/782 [01:31<00:00,  8.53it/s]
100%|██████████████████████████████████████████████| 157/157 [00:12<00:00, 12.74it/s]
Val Epoch 11 loss:0.24019541349380638
Train Epoch 11 loss:0.17053543864403997
100%|██████████████████████████████████████████████| 782/782 [01:26<00:00,  9.01it/s]
100%|██████████████████████████████████████████████| 157/157 [00:10<00:00, 15.01it/s]
Val Epoch 12 loss:0.22717823790516822
Train Epoch 12 loss:0.16016111761341087
100%|██████████████████████████████████████████████| 782/782 [01:21<00:00,  9.64it/s]
100%|██████████████████████████████████████████████| 157/157 [00:10<00:00, 14.95it/s]
Val Epoch 13 loss:0.22390992856424324
Train Epoch 13 loss:0.14971137007036248
100%|██████████████████████████████████████████████| 782/782 [01:12<00:00, 10.74it/s]
100%|██████████████████████████████████████████████| 157/157 [00:09<00:00, 16.97it/s]
Val Epoch 14 loss:0.21716949599943344
Train Epoch 14 loss:0.1396111181420286
100%|██████████████████████████████████████████████| 782/782 [01:15<00:00, 10.31it/s]
100%|██████████████████████████████████████████████| 157/157 [00:10<00:00, 15.21it/s]
Val Epoch 15 loss:0.23596558121928743
Train Epoch 15 loss:0.1312767564369094
100%|██████████████████████████████████████████████| 782/782 [01:16<00:00, 10.17it/s]
100%|██████████████████████████████████████████████| 157/157 [00:10<00:00, 15.43it/s]
Val Epoch 16 loss:0.22408587224544232
Train Epoch 16 loss:0.12150291366802762
100%|██████████████████████████████████████████████| 782/782 [01:17<00:00, 10.06it/s]
100%|██████████████████████████████████████████████| 157/157 [00:09<00:00, 15.78it/s]
Val Epoch 17 loss:0.24303785251204374
Train Epoch 17 loss:0.11278090312543428
100%|██████████████████████████████████████████████| 782/782 [01:18<00:00,  9.94it/s]
100%|██████████████████████████████████████████████| 157/157 [00:10<00:00, 14.57it/s]
Val Epoch 18 loss:0.23729872098489171
Train Epoch 18 loss:0.10480204374705682
100%|██████████████████████████████████████████████| 782/782 [01:17<00:00, 10.03it/s]
100%|██████████████████████████████████████████████| 157/157 [00:10<00:00, 15.64it/s]
Val Epoch 19 loss:0.243593923439076
Train Epoch 19 loss:0.09685046959113415
100%|██████████████████████████████████████████████| 782/782 [01:15<00:00, 10.31it/s]
100%|██████████████████████████████████████████████| 157/157 [00:10<00:00, 15.59it/s]
Val Epoch 20 loss:0.2437899505399215
Train Epoch 20 loss:0.08854851065575124
100%|██████████████████████████████████████████████| 782/782 [01:19<00:00,  9.80it/s]
100%|██████████████████████████████████████████████| 157/157 [00:10<00:00, 14.86it/s]
Val Epoch 21 loss:0.27084284401528397
Train Epoch 21 loss:0.08179470482687264
100%|██████████████████████████████████████████████| 782/782 [01:10<00:00, 11.15it/s]
100%|██████████████████████████████████████████████| 157/157 [00:09<00:00, 17.42it/s]
Val Epoch 22 loss:0.2587211099304971
Train Epoch 22 loss:0.07529176171044902
100%|██████████████████████████████████████████████| 782/782 [01:08<00:00, 11.34it/s]
100%|██████████████████████████████████████████████| 157/157 [00:09<00:00, 17.10it/s]
Val Epoch 23 loss:0.24523643314079113
Train Epoch 23 loss:0.07077955566537197
100%|██████████████████████████████████████████████| 782/782 [01:10<00:00, 11.08it/s]
100%|██████████████████████████████████████████████| 157/157 [00:08<00:00, 17.49it/s]
Val Epoch 24 loss:0.25239588251444184
Train Epoch 24 loss:0.06434527736947969
100%|██████████████████████████████████████████████| 782/782 [01:07<00:00, 11.64it/s]
100%|██████████████████████████████████████████████| 157/157 [28:17<00:00, 10.81s/it]
Val Epoch 25 loss:0.2681191115622308
Train Epoch 25 loss:0.061426075383225254
Done!
Evaluate on validation set...
100%|██████████████████████████████████████████████| 157/157 [00:16<00:00,  9.79it/s]
Evaluation accuracy: 0.915
Evaluate on test set
100%|██████████████████████████████████████████████| 157/157 [00:16<00:00,  9.80it/s]
Evaluation accuracy: 0.9125
Network(
  (conv1): Conv2d(1, 20, kernel_size=(5, 5), stride=(1, 1), padding=(2, 2))
  (pool): MaxPool2d(kernel_size=(2, 2), stride=(2, 2), padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(20, 50, kernel_size=(5, 5), stride=(1, 1), padding=(2, 2))
  (fc1): Linear(in_features=2450, out_features=500, bias=True)
  (fc2): Linear(in_features=500, out_features=10, bias=True)
)
100%|██████████████████████████████████████████████| 157/157 [05:28<00:00,  2.10s/it]
Test accuracy on Attacked Test Data is: 0.158 and Attack Success Rate (accuracy) is: 0.842
Attack Success Rate (accuracy) for PGD on Test Data is: 0.9661
tensor([4, 2, 4, 3, 6, 7, 2, 0, 6, 2])
tensor([3, 9, 9, 3, 0, 9, 0, 8, 4, 9])
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
100%|██████████████████████████████████████████████| 157/157 [00:21<00:00,  7.23it/s]
Evaluation accuracy: 0.9125

#=================================================#

(adml) gremlin@DESKTOP-IR30Q20:~/Documents/Fairness$ python train_fmnist.py 
Loading datasets...
Done!
Start training...
100%|██████████████████████████████████████████████| 782/782 [01:11<00:00, 11.01it/s]
100%|██████████████████████████████████████████████| 157/157 [00:05<00:00, 28.30it/s]
Val Epoch 1 loss:0.4088534061696119
Train Epoch 1 loss:0.5680652072705576
100%|██████████████████████████████████████████████| 782/782 [01:30<00:00,  8.63it/s]
100%|██████████████████████████████████████████████| 157/157 [00:06<00:00, 24.58it/s]
Val Epoch 2 loss:0.35062115188616855
Train Epoch 2 loss:0.36817714017446695
100%|██████████████████████████████████████████████| 782/782 [01:48<00:00,  7.18it/s]
100%|██████████████████████████████████████████████| 157/157 [00:11<00:00, 14.16it/s]
Val Epoch 3 loss:0.30804052939460536
Train Epoch 3 loss:0.31905966627475857
100%|██████████████████████████████████████████████| 782/782 [02:01<00:00,  6.45it/s]
100%|██████████████████████████████████████████████| 157/157 [00:11<00:00, 13.87it/s]
Val Epoch 4 loss:0.29501689959815736
Train Epoch 4 loss:0.2852392574805585
100%|██████████████████████████████████████████████| 782/782 [02:06<00:00,  6.17it/s]
100%|██████████████████████████████████████████████| 157/157 [00:12<00:00, 12.41it/s]
Val Epoch 5 loss:0.26828002782574123
Train Epoch 5 loss:0.2621070243789793
100%|██████████████████████████████████████████████| 782/782 [02:47<00:00,  4.67it/s]
100%|██████████████████████████████████████████████| 157/157 [00:19<00:00,  7.92it/s]
Val Epoch 6 loss:0.2913911280453585
Train Epoch 6 loss:0.24087968885974811
100%|██████████████████████████████████████████████| 782/782 [03:04<00:00,  4.24it/s]
100%|██████████████████████████████████████████████| 157/157 [00:20<00:00,  7.48it/s]
Val Epoch 7 loss:0.2818391620163705
Train Epoch 7 loss:0.22621081699914944
100%|██████████████████████████████████████████████| 782/782 [04:19<00:00,  3.01it/s]
100%|██████████████████████████████████████████████| 157/157 [00:08<00:00, 19.32it/s]
Val Epoch 8 loss:0.23918164981778262
Train Epoch 8 loss:0.21195647963668074
100%|██████████████████████████████████████████████| 782/782 [01:24<00:00,  9.26it/s]
100%|██████████████████████████████████████████████| 157/157 [00:09<00:00, 16.15it/s]
Val Epoch 9 loss:0.23588450357412835
Train Epoch 9 loss:0.1974535346355127
 54%|████████████████████████▋                     | 419/782 [00:50< 54%|████████████████████████▊                     | 421/782 [00:50< 54%|████████████████████████▊                     | 422/782 [00:50< 54%|████████████████████████▉                     | 423/782 [00:50< 54%|████████████████████████▉                     | 424/782 [00:50< 54%|█████████████████████████                     | 425/782 [00:51< 54%|█████████████████████████                     | 426/782 [00:51< 55%|█████████████████████████                     | 427/782 [00:51< 55%|█████████████████████████▏                    | 428/782 [00:51< 55%|█████████████████████████▏                    | 429/782 [00:51< 55%|█████████████████████████▎                    | 430/782 [00:52< 55%|█████████████████████████▎                    | 431/782 [00:52< 55%|█████████████████████████▍                    | 432/782 [00:52< 55%|█████████████████████████▍                    | 433/782 [00:52< 55%|█████████████████████████▌                    | 434/782 [00:53< 56%|█████████████████████████▌                    | 435/782 [00:53< 56%|█████████████████████████▋                    | 436/782 [00:53< 56%|█████████████████████████▋                    | 437/782 [00:53< 56%|█████████████████████████▊                    | 438/782 [00:54< 56%|█████████████████████████▊                    | 439/782 [00:54< 56%|█████████████████████████▉                    | 440/782 [00:54< 56%|█████████████████████████▉                    | 441/782 [00:54< 57%|█████████████████████████▉                    | 442/782 [00:54< 57%|██████████████████████████                    | 443/782 [00:54< 57%|██████████████████████████                    | 444/782 [00:55< 57%|██████████████████████████▏                   | 445/782 [00:55< 57%|██████████████████████████▏                   | 446/782 [00:55< 57%|██████████████████████████▎                   | 447/782 [00:55< 57%|██████████████████████████▎                   | 448/782 [00:55< 57%|██████████████████████████▍                   | 449/782 [00:55< 58%|██████████████████████████▍                   | 450/782 [00:55< 58%|██████████████████████████▌                   | 451/782 [00:55< 58%|██████████████████████████▌                   | 452/782 [00:56< 58%|██████████████████████████▋                   | 453/782 [00:56< 58%|██████████████████████████▋                   | 454/782 [00:56< 58%|██████████████████████████▊                   | 455/782 [00:56< 58%|██████████████████████████▊                   | 456/782 [00:56< 58%|██████████████████████████▉                   | 457/782 [00:56< 59%|██████████████████████████▉                   | 458/782 [00:56< 59%|███████████████████████████                   | 459/782 [00:56< 59%|███████████████████████████                   | 460/782 [00:57< 59%|███████████████████████████                   | 461/782 [00:57< 59%|███████████████████████████▏                  | 462/782 [00:57< 59%|███████████████████████████▏                  | 463/782 [00:57< 59%|███████████████████████████▎                  | 464/782 [00:57< 59%|███████████████████████████▎                  | 465/782 [00:57< 60%|███████████████████████████▍                  | 466/782 [00:58< 60%|███████████████████████████▍                  | 467/782 [00:58< 60%|███████████████████████████▌                  | 468/782 [00:58< 60%|███████████████████████████▌                  | 469/782 [00:58< 60%|███████████████████████████▋                  | 470/782 [00:58< 60%|███████████████████████████▋                  | 471/782 [00:58< 60%|███████████████████████████▊                  | 472/782 [00:59< 60%|███████████████████████████▊                  | 473/782 [00:59< 61%|███████████████████████████▉                  | 474/782 [00:59< 61%|███████████████████████████▉                  | 475/782 [00:59< 61%|████████████████████████████                  | 476/782 [00:59< 61%|████████████████████████████                  | 477/782 [00:59< 61%|████████████████████████████                  | 478/782 [00:59< 61%|████████████████████████████▏                 | 479/782 [00:59< 61%|████████████████████████████▏                 | 480/782 [01:00< 62%|████████████████████████████▎                 | 481/782 [01:00< 62%|████████████████████████████▎                 | 482/782 [01:00< 62%|████████████████████████████▍                 | 483/782 [01:00< 62%|████████████████████████████▍                 | 484/782 [01:00< 62%|████████████████████████████▌                 | 485/782 [01:00< 62%|████████████████████████████▌                 | 486/782 [01:00< 62%|████████████████████████████▋                 | 487/782 [01:00< 62%|████████████████████████████▋                 | 488/782 [01:00< 63%|████████████████████████████▊                 | 489/782 [01:01< 63%|████████████████████████████▊                 | 490/782 [01:01< 63%|████████████████████████████▉                 | 491/782 [01:01< 63%|████████████████████████████▉                 | 492/782 [01:01< 63%|█████████████████████████████                 | 493/782 [01:01< 63%|█████████████████████████████                 | 494/782 [01:01< 63%|█████████████████████████████                 | 495/782 [01:01< 63%|█████████████████████████████▏                | 496/782 [01:01< 64%|█████████████████████████████▏                | 497/782 [01:02< 64%|█████████████████████████████▎                | 498/782 [01:02< 64%|█████████████████████████████▎                | 499/782 [01:02< 64%|█████████████████████████████▍                | 500/782 [01:02< 64%|█████████████████████████████▍                | 501/782 [01:02< 64%|█████████████████████████████▌                | 502/782 [01:02< 64%|█████████████████████████████▌                | 503/782 [01:03< 64%|█████████████████████████████▋                | 504/782 [01:03< 65%|█████████████████████████████▋                | 505/782 [01:03< 65%|█████████████████████████████▊                | 506/782 [01:03< 65%|█████████████████████████████▊                | 507/782 [01:03< 65%|█████████████████████████████▉                | 508/782 [01:03< 65%|█████████████████████████████▉                | 509/782 [01:04< 65%|██████████████████████████████                | 510/782 [01:04< 65%|██████████████████████████████                | 511/782 [01:04< 65%|██████████████████████████████                | 512/782 [01:04< 66%|██████████████████████████████▏               | 513/782 [01:04< 66%|██████████████████████████████▏               | 514/782 [01:04< 66%|██████████████████████████████▎               | 515/782 [01:04< 66%|██████████████████████████████▎               | 516/782 [01:04< 66%|██████████████████████████████▍               | 517/782 [01:05< 66%|██████████████████████████████▍               | 518/782 [01:05< 66%|██████████████████████████████▌               | 519/782 [01:05< 66%|██████████████████████████████▌               | 520/782 [01:05< 67%|██████████████████████████████▋               | 521/782 [01:05< 67%|██████████████████████████████▋               | 522/782 [01:05< 67%|██████████████████████████████▊               | 523/782 [01:05< 67%|██████████████████████████████▊               | 524/782 [01:05< 67%|██████████████████████████████▉               | 525/782 [01:05< 67%|██████████████████████████████▉               | 526/782 [01:06< 67%|███████████████████████████████               | 527/782 [01:06< 68%|███████████████████████████████               | 528/782 [01:06< 68%|███████████████████████████████               | 529/782 [01:06< 68%|███████████████████████████████▏              | 530/782 [01:06< 68%|███████████████████████████████▏              | 531/782 [01:06< 68%|███████████████████████████████▎              | 532/782 [01:06< 68%|███████████████████████████████▎              | 533/782 [01:06< 68%|███████████████████████████████▍              | 534/782 [01:06< 68%|███████████████████████████████▍              | 535/782 [01:07< 69%|███████████████████████████████▌              | 536/782 [01:07< 69%|███████████████████████████████▌              | 537/782 [01:07< 69%|███████████████████████████████▋              | 538/782 [01:07< 69%|███████████████████████████████▋              | 539/782 [01:07< 69%|███████████████████████████████▊              | 540/782 [01:07< 69%|███████████████████████████████▊              | 541/782 [01:08< 69%|███████████████████████████████▉              | 542/782 [01:08< 69%|███████████████████████████████▉              | 543/782 [01:08< 70%|████████████████████████████████              | 544/782 [01:08< 70%|████████████████████████████████              | 545/782 [01:08< 70%|████████████████████████████████              | 546/782 [01:08< 70%|████████████████████████████████▏             | 547/782 [01:08< 70%|████████████████████████████████▏             | 548/782 [01:08< 70%|████████████████████████████████▎             | 549/782 [01:09< 70%|████████████████████████████████▎             | 550/782 [01:09< 70%|████████████████████████████████▍             | 551/782 [01:09< 71%|████████████████████████████████▍             | 552/782 [01:09< 71%|████████████████████████████████▌             | 553/782 [01:09< 71%|████████████████████████████████▌             | 554/782 [01:09< 71%|████████████████████████████████▋             | 555/782 [01:09< 71%|████████████████████████████████▋             | 556/782 [01:09< 71%|████████████████████████████████▊             | 557/782 [01:09< 71%|████████████████████████████████▊             | 558/782 [01:10< 71%|████████████████████████████████▉             | 559/782 [01:10< 72%|████████████████████████████████▉             | 560/782 [01:10< 72%|█████████████████████████████████             | 561/782 [01:10< 72%|█████████████████████████████████             | 563/782 [01:10< 72%|█████████████████████████████████▏            | 564/782 [01:10< 72%|█████████████████████████████████▏            | 565/782 [01:10< 72%|█████████████████████████████████▎            | 566/782 [01:10< 73%|█████████████████████████████████▎            | 567/782 [01:11< 73%|█████████████████████████████████▍            | 569/782 [01:11< 73%|█████████████████████████████████▌            | 570/782 [01:11< 73%|█████████████████████████████████▌            | 571/782 [01:11< 73%|█████████████████████████████████▋            | 572/782 [01:11< 73%|█████████████████████████████████▋            | 573/782 [01:11< 74%|█████████████████████████████████▊            | 575/782 [01:11< 74%|█████████████████████████████████▉            | 576/782 [01:12< 74%|█████████████████████████████████▉            | 577/782 [01:12< 74%|██████████████████████████████████            | 578/782 [01:12< 74%|██████████████████████████████████            | 579/782 [01:12< 74%|██████████████████████████████████            | 580/782 [01:12< 74%|██████████████████████████████████▏           | 581/782 [01:13< 74%|██████████████████████████████████▏           | 582/782 [01:13< 75%|██████████████████████████████████▎           | 583/782 [01:13< 75%|██████████████████████████████████▎           | 584/782 [01:13< 75%|██████████████████████████████████▍           | 585/782 [01:13< 75%|██████████████████████████████████▍           | 586/782 [01:13< 75%|██████████████████████████████████▌           | 587/782 [01:13< 75%|██████████████████████████████████▌           | 588/782 [01:14< 75%|██████████████████████████████████▋           | 589/782 [01:14< 75%|██████████████████████████████████▋           | 590/782 [01:14< 76%|██████████████████████████████████▊           | 591/782 [01:14< 76%|██████████████████████████████████▊           | 592/782 [01:14< 76%|██████████████████████████████████▉           | 593/782 [01:15< 76%|██████████████████████████████████▉           | 594/782 [01:15< 76%|███████████████████████████████████           | 595/782 [01:15< 76%|███████████████████████████████████           | 596/782 [01:15< 76%|███████████████████████████████████           | 597/782 [01:15< 76%|███████████████████████████████████▏          | 598/782 [01:16< 77%|███████████████████████████████████▏          | 599/782 [01:16< 77%|███████████████████████████████████▎          | 600/782 [01:16< 77%|███████████████████████████████████▎          | 601/782 [01:17< 77%|███████████████████████████████████▍          | 602/782 [01:18< 77%|███████████████████████████████████▍          | 603/782 [01:18< 77%|███████████████████████████████████▌          | 604/782 [01:19< 77%|███████████████████████████████████▌          | 605/782 [01:19< 77%|███████████████████████████████████▋          | 606/782 [01:19< 78%|███████████████████████████████████▋          | 607/782 [01:19< 78%|███████████████████████████████████▊          | 608/782 [01:20< 78%|███████████████████████████████████▊          | 609/782 [01:20< 78%|███████████████████████████████████▉          | 610/782 [01:20< 78%|███████████████████████████████████▉          | 611/782 [01:20< 78%|████████████████████████████████████          | 612/782 [01:20< 78%|████████████████████████████████████          | 613/782 [01:21< 79%|████████████████████████████████████          | 614/782 [01:21< 79%|████████████████████████████████████▏         | 615/782 [01:21< 79%|████████████████████████████████████▏         | 616/782 [01:21< 79%|████████████████████████████████████▎         | 617/782 [01:21< 79%|████████████████████████████████████▎         | 618/782 [01:21< 79%|████████████████████████████████████▍         | 619/782 [01:22< 79%|████████████████████████████████████▍         | 620/782 [01:22< 79%|████████████████████████████████████▌         | 621/782 [01:22< 80%|████████████████████████████████████▌         | 622/782 [01:22< 80%|████████████████████████████████████▋         | 623/782 [01:23< 80%|████████████████████████████████████▋         | 624/782 [01:23< 80%|████████████████████████████████████▊         | 625/782 [01:24< 80%|████████████████████████████████████▊         | 626/782 [01:24< 80%|████████████████████████████████████▉         | 627/782 [01:24< 80%|████████████████████████████████████▉         | 628/782 [01:24< 80%|█████████████████████████████████████         | 629/782 [01:24< 81%|█████████████████████████████████████         | 630/782 [01:24< 81%|█████████████████████████████████████         | 631/782 [01:25< 81%|█████████████████████████████████████▏        | 632/782 [01:25< 81%|█████████████████████████████████████▏        | 633/782 [01:25< 81%|█████████████████████████████████████▎        | 634/782 [01:25< 81%|█████████████████████████████████████▎        | 635/782 [01:25< 81%|█████████████████████████████████████▍        | 636/782 [01:25< 81%|█████████████████████████████████████▍        | 637/782 [01:26< 82%|█████████████████████████████████████▌        | 638/782 [01:26< 82%|█████████████████████████████████████▌        | 639/782 [01:26< 82%|█████████████████████████████████████▋        | 640/782 [01:26< 82%|█████████████████████████████████████▋        | 641/782 [01:26< 82%|█████████████████████████████████████▊        | 642/782 [01:26< 82%|█████████████████████████████████████▊        | 643/782 [01:26< 82%|█████████████████████████████████████▉        | 644/782 [01:27< 82%|█████████████████████████████████████▉        | 645/782 [01:27< 83%|██████████████████████████████████████        | 646/782 [01:27< 83%|██████████████████████████████████████        | 647/782 [01:28< 83%|██████████████████████████████████████        | 648/782 [01:28< 83%|██████████████████████████████████████▏       | 649/782 [01:28< 83%|██████████████████████████████████████▏       | 650/782 [01:28< 83%|██████████████████████████████████████▎       | 651/782 [01:28< 83%|██████████████████████████████████████▎       | 652/782 [01:28< 84%|██████████████████████████████████████▍       | 653/782 [01:29< 84%|██████████████████████████████████████▍       | 654/782 [01:29< 84%|██████████████████████████████████████▌       | 655/782 [01:29< 84%|██████████████████████████████████████▌       | 656/782 [01:29< 84%|██████████████████████████████████████▋       | 657/782 [01:29< 84%|██████████████████████████████████████▋       | 658/782 [01:29< 84%|██████████████████████████████████████▊       | 659/782 [01:29< 84%|██████████████████████████████████████▊       | 660/782 [01:29< 85%|██████████████████████████████████████▉       | 661/782 [01:30< 85%|██████████████████████████████████████▉       | 662/782 [01:30< 85%|███████████████████████████████████████       | 663/782 [01:30< 85%|███████████████████████████████████████       | 664/782 [01:30< 85%|███████████████████████████████████████       | 665/782 [01:30< 85%|███████████████████████████████████████▏      | 666/782 [01:30< 85%|███████████████████████████████████████▏      | 667/782 [01:30< 85%|███████████████████████████████████████▎      | 668/782 [01:30< 86%|███████████████████████████████████████▎      | 669/782 [01:31< 86%|███████████████████████████████████████▍      | 670/782 [01:31< 86%|███████████████████████████████████████▍      | 671/782 [01:31< 86%|███████████████████████████████████████▌      | 672/782 [01:31< 86%|███████████████████████████████████████▌      | 673/782 [01:31< 86%|███████████████████████████████████████▋      | 674/782 [01:31< 86%|███████████████████████████████████████▋      | 675/782 [01:31< 86%|███████████████████████████████████████▊      | 676/782 [01:32< 87%|███████████████████████████████████████▊      | 677/782 [01:32< 87%|███████████████████████████████████████▉      | 678/782 [01:32< 87%|███████████████████████████████████████▉      | 679/782 [01:32< 87%|████████████████████████████████████████      | 680/782 [01:32< 87%|████████████████████████████████████████      | 681/782 [01:32< 87%|████████████████████████████████████████      | 682/782 [01:33< 87%|████████████████████████████████████████▏     | 683/782 [01:33< 87%|████████████████████████████████████████▏     | 684/782 [01:33< 88%|████████████████████████████████████████▎     | 685/782 [01:33< 88%|████████████████████████████████████████▎     | 686/782 [01:33< 88%|████████████████████████████████████████▍     | 687/782 [01:33< 88%|████████████████████████████████████████▍     | 688/782 [01:33< 88%|████████████████████████████████████████▌     | 689/782 [01:33< 88%|████████████████████████████████████████▌     | 690/782 [01:34< 88%|████████████████████████████████████████▋     | 691/782 [01:34< 88%|████████████████████████████████████████▋     | 692/782 [01:34< 89%|████████████████████████████████████████▊     | 693/782 [01:34< 89%|████████████████████████████████████████▊     | 694/782 [01:34< 89%|████████████████████████████████████████▉     | 695/782 [01:34< 89%|████████████████████████████████████████▉     | 696/782 [01:34< 89%|█████████████████████████████████████████     | 697/782 [01:34< 89%|█████████████████████████████████████████     | 698/782 [01:35< 89%|█████████████████████████████████████████     | 699/782 [01:35< 90%|█████████████████████████████████████████▏    | 700/782 [01:35< 90%|█████████████████████████████████████████▏    | 701/782 [01:35< 90%|█████████████████████████████████████████▎    | 702/782 [01:35< 90%|█████████████████████████████████████████▎    | 703/782 [01:35< 90%|█████████████████████████████████████████▍    | 704/782 [01:35< 90%|█████████████████████████████████████████▍    | 705/782 [01:35< 90%|█████████████████████████████████████████▌    | 706/782 [01:35< 90%|█████████████████████████████████████████▌    | 707/782 [01:36< 91%|█████████████████████████████████████████▋    | 708/782 [01:36< 91%|█████████████████████████████████████████▋    | 709/782 [01:36< 91%|█████████████████████████████████████████▊    | 710/782 [01:36< 91%|█████████████████████████████████████████▊    | 711/782 [01:36< 91%|█████████████████████████████████████████▉    | 712/782 [01:36< 91%|█████████████████████████████████████████▉    | 713/782 [01:36< 91%|██████████████████████████████████████████    | 714/782 [01:36< 91%|██████████████████████████████████████████    | 715/782 [01:36< 92%|██████████████████████████████████████████    | 716/782 [01:37< 92%|██████████████████████████████████████████▏   | 717/782 [01:37< 92%|██████████████████████████████████████████▏   | 718/782 [01:37< 92%|██████████████████████████████████████████▎   | 719/782 [01:37< 92%|██████████████████████████████████████████▎   | 720/782 [01:37< 92%|██████████████████████████████████████████▍   | 721/782 [01:37< 92%|██████████████████████████████████████████▍   | 722/782 [01:38< 92%|██████████████████████████████████████████▌   | 723/782 [01:38< 93%|██████████████████████████████████████████▌   | 724/782 [01:38< 93%|██████████████████████████████████████████▋   | 725/782 [01:38< 93%|██████████████████████████████████████████▋   | 726/782 [01:38< 93%|██████████████████████████████████████████▊   | 727/782 [01:38< 93%|██████████████████████████████████████████▊   | 728/782 [01:38< 93%|██████████████████████████████████████████▉   | 729/782 [01:38< 93%|██████████████████████████████████████████▉   | 730/782 [01:39< 93%|███████████████████████████████████████████   | 731/782 [01:39< 94%|███████████████████████████████████████████   | 732/782 [01:39< 94%|███████████████████████████████████████████   | 733/782 [01:39< 94%|███████████████████████████████████████████▏  | 734/782 [01:39< 94%|███████████████████████████████████████████▏  | 735/782 [01:39< 94%|███████████████████████████████████████████▎  | 736/782 [01:39< 94%|███████████████████████████████████████████▎  | 737/782 [01:39< 94%|███████████████████████████████████████████▍  | 738/782 [01:39< 95%|███████████████████████████████████████████▍  | 739/782 [01:40< 95%|███████████████████████████████████████████▌  | 740/782 [01:40< 95%|███████████████████████████████████████████▌  | 741/782 [01:40< 95%|███████████████████████████████████████████▋  | 742/782 [01:40< 95%|███████████████████████████████████████████▋  | 743/782 [01:40< 95%|███████████████████████████████████████████▊  | 744/782 [01:40< 95%|███████████████████████████████████████████▊  | 745/782 [01:40< 95%|███████████████████████████████████████████▉  | 746/782 [01:40< 96%|███████████████████████████████████████████▉  | 747/782 [01:41< 96%|████████████████████████████████████████████  | 748/782 [01:41< 96%|████████████████████████████████████████████  | 749/782 [01:41< 96%|████████████████████████████████████████████  | 750/782 [01:41< 96%|████████████████████████████████████████████▏ | 751/782 [01:41< 96%|████████████████████████████████████████████▏ | 752/782 [01:41< 96%|████████████████████████████████████████████▎ | 753/782 [01:41< 96%|████████████████████████████████████████████▎ | 754/782 [01:41< 97%|████████████████████████████████████████████▍ | 755/782 [01:42< 97%|████████████████████████████████████████████▍ | 756/782 [01:42< 97%|████████████████████████████████████████████▌ | 757/782 [01:42< 97%|████████████████████████████████████████████▌ | 758/782 [01:42< 97%|████████████████████████████████████████████▋ | 759/782 [01:42< 97%|████████████████████████████████████████████▋ | 760/782 [01:42< 97%|████████████████████████████████████████████▊ | 761/782 [01:43< 97%|████████████████████████████████████████████▊ | 762/782 [01:43< 98%|████████████████████████████████████████████▉ | 763/782 [01:43< 98%|████████████████████████████████████████████▉ | 764/782 [01:43< 98%|█████████████████████████████████████████████ | 765/782 [01:43< 98%|█████████████████████████████████████████████ | 766/782 [01:43< 98%|█████████████████████████████████████████████ | 767/782 [01:43< 98%|█████████████████████████████████████████████▏| 768/782 [01:43< 98%|█████████████████████████████████████████████▏| 769/782 [01:44< 98%|█████████████████████████████████████████████▎| 770/782 [01:44< 99%|█████████████████████████████████████████████▍| 772/782 [01:44< 99%|█████████████████████████████████████████████▍| 773/782 [01:44< 99%|█████████████████████████████████████████████▌| 774/782 [01:44< 99%|█████████████████████████████████████████████▌| 775/782 [01:44< 99%|█████████████████████████████████████████████▋| 776/782 [01:44< 99%|█████████████████████████████████████████████▋| 777/782 [01:45< 99%|█████████████████████████████████████████████▊| 778/782 [01:45<100%|█████████████████████████████████████████████▊| 779/782 [01:45<100%|█████████████████████████████████████████████▉| 780/782 [01:45<100%|█████████████████████████████████████████████▉| 781/782 [01:45<100%|██████████████████████████████████████████████| 782/782 [01:45<00:00,  7.41it/s]
100%|█████████████████████████████| 157/157 [00:11<00:00, 13.42it/s]
Val Epoch 10 loss:0.23584255315126126
Train Epoch 10 loss:0.18635047536791133
100%|█████████████████████████████| 782/782 [01:43<00:00,  7.57it/s]
100%|█████████████████████████████| 157/157 [00:12<00:00, 12.93it/s]
Val Epoch 11 loss:0.2498903963121639
Train Epoch 11 loss:0.1716192467924198
100%|█████████████████████████████| 782/782 [01:40<00:00,  7.76it/s]
100%|█████████████████████████████| 157/157 [00:12<00:00, 12.64it/s]
Val Epoch 12 loss:0.2316551403065396
Train Epoch 12 loss:0.16203383428742513
100%|█████████████████████████████| 782/782 [01:42<00:00,  7.61it/s]
100%|█████████████████████████████| 157/157 [00:11<00:00, 13.19it/s]
Val Epoch 13 loss:0.22969456792921777
Train Epoch 13 loss:0.14954456646957665
100%|█████████████████████████████| 782/782 [01:40<00:00,  7.76it/s]
100%|█████████████████████████████| 157/157 [00:12<00:00, 12.25it/s]
Val Epoch 14 loss:0.23660706937502904
Train Epoch 14 loss:0.14047030308295774
100%|█████████████████████████████| 782/782 [01:49<00:00,  7.14it/s]
100%|█████████████████████████████| 157/157 [00:14<00:00, 10.49it/s]
Val Epoch 15 loss:0.23477220487822392
Train Epoch 15 loss:0.13085233757648704
100%|█████████████████████████████| 782/782 [02:03<00:00,  6.35it/s]
100%|█████████████████████████████| 157/157 [00:19<00:00,  8.10it/s]
Val Epoch 16 loss:0.2565491626596755
Train Epoch 16 loss:0.1215255410098435
100%|█████████████████████████████| 782/782 [02:19<00:00,  5.61it/s]
100%|█████████████████████████████| 157/157 [00:21<00:00,  7.41it/s]
Val Epoch 17 loss:0.2306925671970009
Train Epoch 17 loss:0.11180066704854864
100%|█████████████████████████████| 782/782 [02:29<00:00,  5.24it/s]
100%|█████████████████████████████| 157/157 [00:24<00:00,  6.35it/s]
Val Epoch 18 loss:0.23481222937939464
Train Epoch 18 loss:0.10391417228142776
100%|█████████████████████████████| 782/782 [02:08<00:00,  6.10it/s]
100%|█████████████████████████████| 157/157 [00:25<00:00,  6.21it/s]
Val Epoch 19 loss:0.26154506797338745
Train Epoch 19 loss:0.09484333844136095
100%|█████████████████████████████| 782/782 [06:08<00:00,  2.12it/s]
100%|█████████████████████████████| 157/157 [01:17<00:00,  2.02it/s]
Val Epoch 20 loss:0.2582864922228133
Train Epoch 20 loss:0.08733131449974482
100%|█████████████████████████████| 782/782 [08:14<00:00,  1.58it/s]
100%|█████████████████████████████| 157/157 [00:46<00:00,  3.40it/s]
Val Epoch 21 loss:0.24850356481542255
Train Epoch 21 loss:0.08208709450491021
100%|█████████████████████████████| 782/782 [05:28<00:00,  2.38it/s]
100%|█████████████████████████████| 157/157 [00:29<00:00,  5.40it/s]
Val Epoch 22 loss:0.2532488401196185
Train Epoch 22 loss:0.07443349471177592
100%|█████████████████████████████| 782/782 [04:32<00:00,  2.87it/s]
100%|█████████████████████████████| 157/157 [00:33<00:00,  4.71it/s]
Val Epoch 23 loss:0.2579817588257182
Train Epoch 23 loss:0.06833071301422079
100%|█████████████████████████████| 782/782 [04:49<00:00,  2.70it/s]
100%|█████████████████████████████| 157/157 [00:45<00:00,  3.46it/s]
Val Epoch 24 loss:0.2722214689110495
Train Epoch 24 loss:0.06470197429666129
100%|█████████████████████████████| 782/782 [07:56<00:00,  1.64it/s]
100%|█████████████████████████████| 157/157 [00:53<00:00,  2.95it/s]
Val Epoch 25 loss:0.2747151720912973
Train Epoch 25 loss:0.06130844406554919
Done!
Evaluate on validation set...
100%|█████████████████████████████| 157/157 [00:35<00:00,  4.43it/s]
Evaluation accuracy: 0.9172
Evaluate on test set
100%|█████████████████████████████| 157/157 [00:33<00:00,  4.63it/s]
Evaluation accuracy: 0.9145
Network(
  (conv1): Conv2d(1, 20, kernel_size=(5, 5), stride=(1, 1), padding=(2, 2))
  (pool): MaxPool2d(kernel_size=(2, 2), stride=(2, 2), padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(20, 50, kernel_size=(5, 5), stride=(1, 1), padding=(2, 2))
  (fc1): Linear(in_features=2450, out_features=500, bias=True)
  (fc2): Linear(in_features=500, out_features=10, bias=True)
)
100%|█████████████████████████████| 157/157 [11:41<00:00,  4.47s/it]
Test accuracy on Attacked Test Data is: 0.1475 and Attack Success Rate (accuracy) is: 0.8525
Attack Success Rate (accuracy) for PGD on Test Data is: 0.9656
tensor([7, 8, 8, 2, 0, 3, 6, 3, 8, 8])
tensor([4, 7, 2, 1, 9, 3, 4, 9, 5, 7])
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
100%|█████████████████████████████| 157/157 [00:33<00:00,  4.76it/s]
Evaluation accuracy: 0.9145

#=================================================#

#n=10

Test accuracy on Attacked Test Data is: 0.1364 and Attack Success Rate (accuracy) is: 0.8636
Attack Success Rate (accuracy) for PGD on Test Data is: 0.9697

#n=5

Test accuracy on Attacked Test Data is: 0.1364 and Attack Success Rate (accuracy) is: 0.8636
Attack Success Rate (accuracy) for PGD on Test Data is: 0.7505

#n=2

Test accuracy on Attacked Test Data is: 0.1364 and Attack Success Rate (accuracy) is: 0.8636
Attack Success Rate (accuracy) for PGD on Test Data is: 0.3724

#n=1

Test accuracy on Attacked Test Data is: 0.1364 and Attack Success Rate (accuracy) is: 0.8636
Attack Success Rate (accuracy) for PGD on Test Data is: 0.2019


